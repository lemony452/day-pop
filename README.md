# Day POP ğŸ§

<img src="https://github.com/lemony452/day-pop/assets/109330624/98408a5f-40c0-44a7-964d-0057c291e6a4" width="100">  

> íŒì†¡ì„ ë“£ê³ , ì§ì ‘ ê°€ì‚¬ë¥¼ ì¨ë³´ë©° ì˜ì–´ í•™ìŠµì„ í•  ìˆ˜ ìˆì–´ìš”  
> URL : https://day-pop.vercel.app  

ğŸ“Œ ì´ìš©ì‹œ ì£¼ì˜ì‚¬í•­ : í•´ë‹¹ ì„œë¹„ìŠ¤ëŠ” ìŠ¤í¬í‹°íŒŒì´ í”„ë¦¬ë¯¸ì—„ ê³„ì •ì´ í•„ìš”í•©ë‹ˆë‹¤

# ì§€ì› ê¸°ëŠ¥
- ìŠ¤í¬í‹°íŒŒì´ì—ì„œ ì„¤ì •í•œ ë‚˜ë§Œì˜ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”
- íŒì†¡ì„ ë“¤ìœ¼ë©° ê°€ì‚¬ë¥¼ ì§ì ‘ ì…ë ¥í•˜ë©´ ë“±ê¸‰ì„ ë³´ì—¬ì¤˜ì„œ ë¦¬ë“¬ê²Œì„ì²˜ëŸ¼ ì¬ë°Œê²Œ í•™ìŠµí•  ìˆ˜ ìˆì–´ìš”
- í•™ìŠµ ë‚´ìš©ì„ ì €ì¥í•˜ê³  ì´ì–´í•˜ê¸°ê°€ ê°€ëŠ¥í•´ìš”
- í•™ìŠµì„ í†µí•´ ì¢‹ì€ ê²°ê³¼ë¥¼ ë‚´ë©´ ì ìˆ˜ë¥¼ ìŒ“ê³  ë“±ê¸‰ì„ ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”

# ë°ëª¨ ì˜ìƒ
https://github.com/lemony452/day-pop/assets/109330624/9051f957-f666-4279-a143-8f78c80c95ac

# í”„ë¡œì íŠ¸ ì„¤ëª…

## 1. ê¸°íš ë™ê¸°
ì¢‹ì•„í•˜ëŠ” íŒì†¡ì„ ë“¤ìœ¼ë©° ê²Œì„ì²˜ëŸ¼ ì˜ì–´ ê³µë¶€ë¥¼ í•˜ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì— Day POPì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

## 2. ì„¤ê³„ ë° ë””ìì¸

ë¨¼ì € [ìš”êµ¬ì‚¬í•­ ì •ì˜ì„œ](https://morning-rock-513.notion.site/c4fc7b0f3c9e493cba1abb255fb59e88?pvs=4)ë¥¼ ë°”íƒ•ìœ¼ë¡œ [DB](https://morning-rock-513.notion.site/DB-21974dd0bf2c4d9bb782169ff98bd824?pvs=4)ì™€ [ë””ìì¸](https://www.figma.com/file/zHD0v59XgvknhLWLtcL3rZ/Day-POP?type=design&node-id=0-1&mode=design&t=CMjqZCSjiS7gL9aq-0)ì„ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤  
í™”ë©´ íŒŒíŠ¸ë³„ë¡œ í•µì‹¬ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ìœ ì € í”Œë¡œìš°ë¥¼ ì˜ˆìƒí•˜ê³ , ê°ê°ì˜ ìœ ì € ê¸°ëŠ¥ë“¤ì„ ëª…ì„¸í•˜ë©´ì„œ êµ¬ì²´í™”í–ˆìŠµë‹ˆë‹¤  

### í´ë” êµ¬ì¡°
```
ğŸ“¦ client
â”œâ”€Â public
â””â”€Â src
Â Â Â â”œâ”€Â app
Â Â Â â”‚Â Â â”œâ”€Â callback
Â Â Â â”‚Â Â â”œâ”€Â dashboard
Â Â Â â”‚Â Â â”œâ”€Â detail
Â Â Â â”‚Â Â â”œâ”€Â login
Â Â Â â”‚Â Â â”œâ”€Â myplaylist
Â Â Â â”‚Â Â â”œâ”€Â result
Â Â Â â”‚Â Â â”œâ”€Â signup
Â Â Â â”‚Â Â â””â”€Â study
Â Â Â â”œâ”€Â components
Â Â Â â””â”€Â lib
Â Â Â Â Â Â â”œâ”€Â modal
Â Â Â Â Â Â â”œâ”€Â study
Â Â Â Â Â Â â””â”€Â user
```

```
ğŸ“¦ server
â”œâ”€Â controller
â”œâ”€Â models
â”œâ”€Â routes
â””â”€Â utils
```

## 3. ê¸°ìˆ ìŠ¤íƒ ë° ì‚¬ìš©ì´ìœ 

### FE
`Nextjs`
  - Reactë¥¼ ê¸°ë°˜ìœ¼ë¡œ SSRì„ ì‚¬ìš©í•´ ì´ˆê¸° ë Œë”ë§ì„ ì‹œê°„ì„ ì¤„ì—¬ ì„±ëŠ¥ì„ ê°œì„ í•˜ê³ , SEO ìµœì í™”ì— ìœ ë¦¬í•´ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤
  - ë¼ìš°í„° ê¸°ëŠ¥ì„ ìœ„í•´ ë”°ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ í´ë”ë³„ë¡œ í˜ì´ì§€ ë¼ìš°íŒ…ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

`Redux-Toolkit`
  - ìœ ì € ìƒíƒœ, í•™ìŠµ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ”ë° createSliceë¡œ ì•¡ì…˜ í•¨ìˆ˜ë¥¼ ê°„ê²°í•˜ê²Œ ì •ì˜í•˜ê³ , stateì˜ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë„ë¡ ë„ì™€ì£¼ê¸° ë•Œë¬¸ì— ì„ íƒí–ˆìŠµë‹ˆë‹¤  
  - createAsyncThunkë¥¼ ì‚¬ìš©í•´ ë¹„ë™ê¸° ë°ì´í„°ë¥¼ íŒ¨ì¹­í•˜ê³  ë¡œë”©, ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤

`Return-Fetch`
  - 401 ì‘ë‹µ ì½”ë“œë¥¼ í™•ì¸í•˜ê³  ì•¡ì„¸ìŠ¤ í† í°ì„ ì¬ë°œê¸‰í•´ í•´ë‹¹ ìš”ì²­ì„ ì¬ì‹œë„í•˜ê¸° ìœ„í•œ intercepter êµ¬í˜„ì„ ëª©ì ìœ¼ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤
  - ì•½ 65kBë¡œ íƒ€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³´ë‹¤ ê°€ë²¼ìš°ë©´ì„œ nextjsì—ì„œ ì œê³µí•˜ëŠ” fetchì˜ ì¥ì ì„ í•´ì¹˜ì§€ ì•Šê³  ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤

`cookies-next`
  - jwt í† í°ì„ ì¿ í‚¤ì— ì €ì¥í•˜ê³  ì‚¬ìš©í•˜ëŠ”ë° ì„œë²„ & í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ ëª¨ë‘ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤
  - ì‰½ê²Œ ì¿ í‚¤ë¥¼ ì„¤ì •, ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ GET, SET ë“± ë‹¤ì–‘í•œ ë§¤ì„œë“œë“¤ì„ ì œê³µí•©ë‹ˆë‹¤

### BE
`Nodejs`
`Express`
`MongoDB`
`Mongoose`

### Deploy
`Vercel`
  - ë¹Œë“œ ë° ë°°í¬ë¥¼ ìë™í™” ê¸°ëŠ¥ì„ ì§€ì›í•´ì£¼ì–´ ì‰½ê²Œ ë°°í¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤
  - Nextjsì˜ SSRì— í•„ìš”í•œ ì„œë²„ë¥¼ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— í”„ë¡ íŠ¸ ë‹¨ ë°°í¬ì— ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤

`Cloudtype`
  - ì„œë²„ê°€ í•œêµ­ì— ìœ„ì¹˜í•´ ì†ë„ê°€ ë¹ ë¥´ê³ , ì‚¬ìš©í•˜ê¸° ì‰¬ìš´ PaaSë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤
  - ë°±ì—”ë“œ ì„œë²„ì™€ DB ë°°í¬ì— ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤

## 4. ê°œë°œ ê³¼ì •

### Nextjs ì»¤ìŠ¤í…€ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì„œë²„ë¥¼ ë¶„ë¦¬í•˜ê²Œ ëœ ì´ìœ 

Nextjsì—ì„œ ì œê³µí•˜ëŠ” ì»¤ìŠ¤í…€ ì„œë²„ì—ì„œ apië¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•  ê³„íšì´ì—ˆìœ¼ë‚˜
[ê³µì‹ë¬¸ì„œ](https://nextjs.org/docs/pages/building-your-application/configuring/custom-server) ë‚´ìš©ì„ í†µí•´ ì„œë²„ë¥¼ ë”°ë¡œ ë§Œë“¤ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤

> ì‚¬ìš©ì ì •ì˜ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í•˜ê¸° ì „ì— Next.jsì˜ í†µí•© ë¼ìš°í„°ê°€ ì•± ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ëª…ì‹¬í•˜ì„¸ìš”
> ë§ì¶¤í˜• ì„œë²„ëŠ” ì„œë²„ë¦¬ìŠ¤ ê¸°ëŠ¥ ë° ìë™ ì •ì  ìµœì í™” ì™€ ê°™ì€ ì¤‘ìš”í•œ ì„±ëŠ¥ ìµœì í™”ë¥¼ ì œê±°í•©ë‹ˆë‹¤
> Vercelì—ëŠ” ì‚¬ìš©ì ì •ì˜ ì„œë²„ë¥¼ ë°°í¬ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤  

Nextjsë¥¼ Vercelë¡œ ë°°í¬í•  ê³„íšì´ì—ˆê³ , ìì²´ JWT ë¡œê·¸ì¸ê³¼ ìœ ì €, íŒì†¡ api ëª¨ë‘ êµ¬í˜„í•˜ë©´ ê·œëª¨ê°€ ë” ì»¤ì§€ê¸° ë•Œë¬¸ì— ë”°ë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ë‚˜ì„ ê²ƒì´ë¼ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤  

### ìŠ¤í¬í‹°íŒŒì´ Oauthë§Œ ì“°ë ¤ë‹¤ê°€ JWT ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ê²Œ ëœ ì´ìœ 

ìŠ¤í¬í‹°íŒŒì´ì˜ ê³ ìœ í•œ userId ê°’ìœ¼ë¡œ Day POP ìœ ì €ì™€ íŒì†¡ í•™ìŠµ ì •ë³´ì— ì‚¬ìš©í•  ìƒê°ì´ì—ˆìŠµë‹ˆë‹¤  
í•˜ì§€ë§Œ ìœ ì € ì •ë³´ê°€ íƒˆì·¨ë˜ë©´ ì´ì°¨ì ì¸ ë³¸ì¸ ì¸ì¦ ìˆ˜ë‹¨ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì— ë³´ì•ˆì— ì·¨ì•½í•˜ì˜€ìŠµë‹ˆë‹¤  
ì„¸ì…˜ ë¡œê·¸ì¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆì—ˆì§€ë§Œ ë‹¹ì‹œ ì„œë²„ ì„¸ì…˜ì— ë¶€ë‹´ì„ ì£¼ëŠ” ë°©ë²•ë³´ë‹¤ ì¤‘ìš”í•œ ì •ë³´ë¥¼ í•´ì‰¬ ì•”í˜¸í™”í•´ ì „ì†¡í•˜ëŠ” ë°©ë²•ì¸ JWTë¥¼ ì„ íƒí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤  
ë˜í•œ ì•¡ì„¸ìŠ¤ í† í° íƒˆì·¨ ì‹œ ìœ„í—˜ì„ ì¤„ì´ê¸° ìœ„í•´ ë§Œë£Œ ì‹œê°„ì„ 1ì‹œê°„ìœ¼ë¡œ ë‘ê³  ë¦¬í”„ë ˆì‹œ í† í°ì„ í†µí•´ ì¬ë°œê¸‰í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤  

### í† í° ìœ ë¬´ì— ë”°ë¼ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬í•˜ê¸°

Nextjsì˜ ë¯¸ë“¤ì›¨ì–´ëŠ” ìºì‹œ ì „, ìš”ì²­ ì „ì— ì‹¤í–‰ë˜ì–´ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê³  ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤  
ë¡œê·¸ì¸ì„ í•  ë•Œ, ìŠ¤í¬í‹°íŒŒì´ ë¦¬í”„ë ˆì‹œ í† í°, ìì²´ ì•¡ì„¸ìŠ¤ í† í°, ë¦¬í”„ë ˆì‹œ í† í° 3ê°€ì§€ë¥¼ ì¿ í‚¤ì— ì €ì¥í•˜ê³  ë‚˜ë©´  
ë¡œê·¸ì¸ ì´í›„ ëª¨ë“  ìš”ì²­ ì „ì— í•´ë‹¹ ìœ ë¬´ë¥¼ ë¯¸ë“¤ì›¨ì–´ì—ì„œ ë¯¸ë¦¬ íŒë‹¨í•  ìˆ˜ ìˆì–´ home, login, myplaylist ê° í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤

### return-fetchë¡œ ì½”ë“œì˜ ì•ˆì •ì„±ê³¼ ì¬ì‚¬ìš©ì„± ë†’ì´ê¸°

ëª¨ë“  API ìš”ì²­ì„ fetchë¡œ êµ¬í˜„í•˜ë‹¤ë³´ë‹ˆ ì¤‘ë³µëœ ì½”ë“œê°€ ë§ì•„ì¡Œê³ , ê·¸ë§Œí¼ ì‹¤ìˆ˜ì— ëŒ€í•œ ìœ„í—˜ë„ë„ ë†’ê³  ìœ ì§€ë³´ìˆ˜ë„ ê¹Œë‹¤ë¡œìš´ ì½”ë“œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤  
ë˜í•œ ëª¨ë“  ìš”ì²­ ì „ì— í† í° ê²€ì¦ì„ í•˜ë‹¤ë³´ë‹ˆ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ëŠê»´ì¡ŒìŠµë‹ˆë‹¤ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©´ì„œ Nextjsì—ì„œ ì œê³µí•˜ëŠ” fetchì˜ ì¥ì ë„ ì·¨í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì°¾ë‹¤ return-fetch ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤  

return-fetchëŠ” ì „ì—­ fetchë¥¼ ê±´ë“œë¦¬ì§€ ì•Šê³  Axiosì²˜ëŸ¼ baseUrl, headerê³¼ ê°™ì€ ê¸°ë³¸ì ì¸ ì„¤ì •ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤  
ë˜í•œ interceptorë¥¼ ì‚¬ìš©í•´ í† í° ì¬ë°œê¸‰ ê³¼ì •ì„ ì¶”ê°€í•˜ê³  ì¬ë°œê¸‰í•œ í† í°ìœ¼ë¡œ í•´ë‹¹ ìš”ì²­ì„ ë‹¤ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤  
í† í°ì„ ê²€ì¦í•˜ëŠ” `fetchVerifyToken` í•¨ìˆ˜ì™€ ê³µí†µ api ìš”ì²­ì„ í•˜ëŠ” `fethcPopsongExtended` í•¨ìˆ˜ 2ê°€ì§€ë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤  
ê¸°ì¡´ì˜ useEffectë¡œ í† í°ì„ ê²€ì¦í•œ ì½”ë“œë“¤ê³¼ createAsyncThunkì— ì‚¬ìš©í–ˆë˜ ê°ê°ì˜ api ìš”ì²­ í•¨ìˆ˜ë“¤ ëª¨ë‘ ìœ„ì˜ ë‘ í•¨ìˆ˜ë“¤ë¡œ ì¤„ì¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤  


```js
// fetch ì‘ë‹µ í›„ í† í° ê²€ì¦ì„ í•˜ê³  ë‹¤ì‹œ fetch ë°˜í™˜
export const fetchVerifyToken = (fetchArgs) =>
  returnFetch({
    ...fetchArgs,
    interceptors: {
      response: async (response, requestArgs, fetch) => {
        // í† í° ì¬ë°œê¸‰ í•„ìš”
        if (response.status !== 401) {
          return response;
        }

        console.log("401 ì—ëŸ¬,, í† í° ì¬ë°œê¸‰ í•„ìš”");
        const access_token = getCookie("access_token");
        const refresh_token = getCookie("refresh_token");
        const resTogetRefresh = await getRefresh(access_token, refresh_token);

        if (resTogetRefresh.status === 401) throw Error(resTogetRefresh.status);

        if (resTogetRefresh.status === 200) {
          const tokenInfo = await resTogetRefresh.json();
          setCookie("access_token", tokenInfo.access_token);
          setCookie("refresh_token", tokenInfo.refresh_token);

          // console.log(requestArgs); // [URL, {}]
          return fetch(requestArgs[0], {
            headers: {
              Authorization: "Bearer " + `${tokenInfo.access_token}`,
              "Content-Type": "application/json",
            },
          });
        }

        return;
      },
    },
  });

// íŒì†¡ api ìš”ì²­ ê³µí†µ
export const fethcPopsongExtended = fetchVerifyToken({
  baseUrl: `${SERVER_URL}`,
  headers: {
    "Content-Type": "application/json",
  },
});
```

## 5. íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

> URL: https://morning-rock-513.notion.site/8386087a94254dafad53ee8d31dc5070?pvs=4


## 6. í”„ë¡œì íŠ¸ í›„ê¸°







